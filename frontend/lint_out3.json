[{"filePath":"D:\\Gravity\\StatSea\\frontend\\.eslintrc.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\App.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\ActiveConnectionsWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\AnalyticsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\BottomNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\CommandPalette.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\ConnectionGlobe.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\DeviceDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\DevicesPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\DnsQueryLog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\DockerManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\GroupManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\NetworkComparison.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\NetworkMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\NotificationCenter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\OnboardingTour.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\PredictionWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\QuotaManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\SecurityAlertsWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\ServerStatusCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\SettingsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\Sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\SpeedtestPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\SpeedtestSettingsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\SystemDetailOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\TopDevicesWidget.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nD:\\Gravity\\StatSea\\frontend\\src\\components\\TopDevicesWidget.tsx:45:9\n  43 |     useEffect(() => {\n  44 |         // eslint-disable-next-line react-hooks/set-state-in-effect\n> 45 |         setDeviceStats(devices.slice(0, 5).map(() => ({\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  46 |             gb: `${Math.floor(Math.random() * 10)}.${Math.floor(Math.random() * 9)}`,\n  47 |             mbps: Math.floor(Math.random() * 50),\n  48 |         })));","line":45,"column":9,"nodeType":null,"endLine":45,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\TopNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\TopStatsRow.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\UptimeTimeline.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLogs'. Either include it or remove the dependency array.","line":48,"column":8,"nodeType":"ArrayExpression","endLine":48,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [deviceId, fetchLogs, range]","fix":{"range":[1677,1694],"text":"[deviceId, fetchLogs, range]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\UserManagement.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\YearlyStatsView.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":40,"column":8,"nodeType":"ArrayExpression","endLine":40,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData, period]","fix":{"range":[1466,1474],"text":"[fetchData, period]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\skeletons\\StatCardSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\components\\skeletons\\WidgetSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\config\\apiConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\config\\axiosInstance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\context\\AuthContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":75,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":75,"endColumn":21}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchUser'. Either include it or remove the dependency array.","line":50,"column":8,"nodeType":"ArrayExpression","endLine":50,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [fetchUser, token]","fix":{"range":[1688,1695],"text":"[fetchUser, token]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport axiosInstance from '../config/axiosInstance';\r\n\r\ninterface User {\r\n    id: number;\r\n    username: string;\r\n    email: string;\r\n    full_name: string | null;\r\n    is_admin: boolean;\r\n}\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    token: string | null;\r\n    refreshToken: string | null;\r\n    login: (token: string, refreshToken: string) => Promise<void>;\r\n    logout: () => void;\r\n    isLoading: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [token, setToken] = useState<string | null>(localStorage.getItem('statsea_token'));\r\n    const [refreshToken, setRefreshToken] = useState<string | null>(localStorage.getItem('statsea_refresh_token'));\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    const fetchUser = async () => {\r\n        try {\r\n            const response = await axiosInstance.get('/auth/me');\r\n            setUser(response.data);\r\n        } catch (error) {\r\n            console.error('Failed to fetch user:', error);\r\n            // logout() is called by axiosInstance on 401, \r\n            // but we call it here to ensure local state is cleared too\r\n            logout();\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (token) {\r\n            fetchUser();\r\n        } else {\r\n            setIsLoading(false);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [token]);\r\n\r\n    const login = async (newToken: string, newRefreshToken: string) => {\r\n        localStorage.setItem('statsea_token', newToken);\r\n        localStorage.setItem('statsea_refresh_token', newRefreshToken);\r\n        setToken(newToken);\r\n        setRefreshToken(newRefreshToken);\r\n        await fetchUser();\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem('statsea_token');\r\n        localStorage.removeItem('statsea_refresh_token');\r\n        setToken(null);\r\n        setRefreshToken(null);\r\n        setUser(null);\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, token, refreshToken, login, logout, isLoading }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\context\\ThemeContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":116,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":116,"endColumn":25}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'setDefaultTheme'. Either include it or remove the dependency array.","line":91,"column":8,"nodeType":"ArrayExpression","endLine":91,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [setDefaultTheme]","fix":{"range":[3282,3284],"text":"[setDefaultTheme]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport { ThemeConfig, ThemeMode, accentColors, presets } from '../lib/themes';\r\n\r\n\r\ninterface ThemeContextType {\r\n    themeConfig: ThemeConfig;\r\n    setThemeConfig: (config: ThemeConfig) => void;\r\n    updateTheme: (updates: Partial<ThemeConfig>) => void;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\r\n    const [themeConfig, setThemeConfig] = useState<ThemeConfig>({\r\n        mode: 'dark',\r\n        accent: accentColors[0].value\r\n    });\r\n\r\n    const applyTheme = (config: ThemeConfig) => {\r\n        const root = document.documentElement;\r\n        const base = presets[config.mode];\r\n\r\n        if (!base) return;\r\n\r\n        // Apply mode class for Tailwind dark mode selector\r\n        if (config.mode === 'light') {\r\n            root.classList.remove('dark');\r\n            root.classList.add('light');\r\n        } else {\r\n            root.classList.remove('light');\r\n            root.classList.add('dark');\r\n        }\r\n\r\n        // Apply base theme variables\r\n        Object.entries(base.colors).forEach(([key, value]) => {\r\n            if (key !== '--accent' && key !== '--accent-foreground') {\r\n                root.style.setProperty(key, value);\r\n            }\r\n        });\r\n\r\n        // Apply accent color override\r\n        root.style.setProperty('--primary', config.accent);\r\n        root.style.setProperty('--ring', config.accent);\r\n        root.style.setProperty('--accent', config.accent);\r\n\r\n        // Special handling for radius if Cyberpunk\r\n        if (config.mode === 'cyberpunk') {\r\n            root.style.setProperty('--radius', '0px');\r\n        } else {\r\n            root.style.setProperty('--radius', '0.5rem');\r\n        }\r\n    };\r\n\r\n    const setDefaultTheme = () => {\r\n        const def = { mode: 'dark' as ThemeMode, accent: accentColors[0].value };\r\n        setThemeConfig(def);\r\n        applyTheme(def);\r\n        localStorage.setItem('themeConfig', JSON.stringify(def));\r\n    };\r\n\r\n    // Initial Load\r\n    useEffect(() => {\r\n        const savedThemeConfig = localStorage.getItem('themeConfig');\r\n        const legacyTheme = localStorage.getItem('theme');\r\n\r\n        if (savedThemeConfig) {\r\n            try {\r\n                const parsed = JSON.parse(savedThemeConfig);\r\n                setThemeConfig(parsed);\r\n                applyTheme(parsed);\r\n            } catch (e) {\r\n                console.error(\"Failed to parse theme config\", e);\r\n                setDefaultTheme();\r\n            }\r\n        } else if (legacyTheme) {\r\n            if (presets[legacyTheme as ThemeMode]) {\r\n                const newConfig: ThemeConfig = {\r\n                    mode: legacyTheme as ThemeMode,\r\n                    accent: presets[legacyTheme as ThemeMode].colors['--primary']\r\n                };\r\n                setThemeConfig(newConfig);\r\n                applyTheme(newConfig);\r\n                localStorage.setItem('themeConfig', JSON.stringify(newConfig));\r\n            } else {\r\n                setDefaultTheme();\r\n            }\r\n        } else {\r\n            setDefaultTheme();\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const updateTheme = (updates: Partial<ThemeConfig>) => {\r\n        const newConfig = { ...themeConfig, ...updates };\r\n\r\n        if (updates.mode) {\r\n            const preset = presets[updates.mode];\r\n            // Optional: Auto-switch accent to the preset's primary color for better default look\r\n            if (preset) {\r\n                newConfig.accent = preset.colors['--primary'];\r\n            }\r\n        }\r\n\r\n        setThemeConfig(newConfig);\r\n        applyTheme(newConfig);\r\n        localStorage.setItem('themeConfig', JSON.stringify(newConfig));\r\n    };\r\n\r\n    return (\r\n        <ThemeContext.Provider value={{ themeConfig, setThemeConfig, updateTheme }}>\r\n            {children}\r\n        </ThemeContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useTheme() {\r\n    const context = useContext(ThemeContext);\r\n    if (context === undefined) {\r\n        throw new Error('useTheme must be used within a ThemeProvider');\r\n    }\r\n    return context;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\contexts\\WebSocketContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":158,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":158,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useEffect, useState, ReactNode } from 'react';\r\nimport { toast } from 'sonner';\r\nimport { getWsUrl } from '../config/apiConfig';\r\n\r\nexport interface Notification {\r\n    id: string;\r\n    title: string;\r\n    description: string;\r\n    timestamp: Date;\r\n    read: boolean;\r\n    type: 'info' | 'warning' | 'error' | 'success';\r\n}\r\n\r\ninterface WebSocketContextType {\r\n    wsData: Record<string, unknown>[];\r\n    isConnected: boolean;\r\n    notifications: Notification[];\r\n    unreadCount: number;\r\n    markAsRead: (id: string) => void;\r\n    markAllAsRead: () => void;\r\n    clearNotifications: () => void;\r\n}\r\n\r\nconst WebSocketContext = createContext<WebSocketContextType | undefined>(undefined);\r\n\r\nexport const WebSocketProvider = ({ children }: { children: ReactNode }) => {\r\n    const [wsData, setWsData] = useState<Record<string, unknown>[]>([]);\r\n    const [isConnected, setIsConnected] = useState(false);\r\n    const [notifications, setNotifications] = useState<Notification[]>([]);\r\n\r\n    const unreadCount = notifications.filter(n => !n.read).length;\r\n\r\n    const markAsRead = (id: string) => {\r\n        setNotifications(prev => prev.map(n => n.id === id ? { ...n, read: true } : n));\r\n    };\r\n\r\n    const markAllAsRead = () => {\r\n        setNotifications(prev => prev.map(n => ({ ...n, read: true })));\r\n    };\r\n\r\n    const clearNotifications = () => {\r\n        setNotifications([]);\r\n    };\r\n\r\n    useEffect(() => {\r\n        let ws: WebSocket | null = null;\r\n        let eventWs: WebSocket | null = null;\r\n        let reconnectTimeout: NodeJS.Timeout;\r\n        let isMounted = true;\r\n\r\n        const connect = () => {\r\n            const wsUrl = getWsUrl('/ws/live');\r\n            const eventWsUrl = getWsUrl('/ws/events');\r\n\r\n            ws = new WebSocket(wsUrl);\r\n            eventWs = new WebSocket(eventWsUrl);\r\n\r\n            ws.onopen = () => {\r\n                if (isMounted) {\r\n                    setIsConnected(true);\r\n                    toast.success('Connected to Live Server');\r\n                }\r\n            };\r\n\r\n            ws.onclose = () => {\r\n                if (isMounted) {\r\n                    setIsConnected(false);\r\n                    // Reconnect after 3 seconds\r\n                    reconnectTimeout = setTimeout(connect, 3000);\r\n                }\r\n            };\r\n\r\n            let lastUpdate = 0;\r\n            const THROTTLE_MS = 500; // Max 2 updates per second\r\n\r\n            ws.onmessage = (event) => {\r\n                const now = Date.now();\r\n                if (now - lastUpdate < THROTTLE_MS) return;\r\n                lastUpdate = now;\r\n\r\n                try {\r\n                    const data = JSON.parse(event.data);\r\n                    setWsData(prev => {\r\n                        const newData = [...prev, {\r\n                            time: new Date(data.timestamp * 1000).toLocaleTimeString(),\r\n                            upload: data.u / 1024,\r\n                            download: data.d / 1024,\r\n                        }];\r\n                        if (newData.length > 20) newData.shift();\r\n                        return newData;\r\n                    });\r\n                } catch (e) {\r\n                    console.error(\"Failed to parse WS message\", e);\r\n                }\r\n            };\r\n\r\n            eventWs.onmessage = (event) => {\r\n                try {\r\n                    const data = JSON.parse(event.data);\r\n\r\n                    // Add to notifications list\r\n                    const newNotification: Notification = {\r\n                        id: Math.random().toString(36).substr(2, 9),\r\n                        title: data.title || 'New Event',\r\n                        description: data.description || '',\r\n                        timestamp: new Date(),\r\n                        read: false,\r\n                        type: data.type === 'error' ? 'error' :\r\n                            data.type === 'warning' ? 'warning' :\r\n                                data.type === 'success' ? 'success' : 'info'\r\n                    };\r\n\r\n                    setNotifications(prev => [newNotification, ...prev]);\r\n\r\n                    // Show toast for high priority events or new devices\r\n                    if (data.type === 'NEW_DEVICE' || data.type === 'security_alert') {\r\n                        toast.warning(data.title, {\r\n                            description: data.description,\r\n                            duration: 5000,\r\n                        });\r\n                    } else {\r\n                        toast.info(data.title, {\r\n                            description: data.description,\r\n                        });\r\n                    }\r\n\r\n                } catch (e) {\r\n                    console.error(\"Failed to parse event message\", e);\r\n                }\r\n            };\r\n        };\r\n\r\n        connect();\r\n\r\n        return () => {\r\n            isMounted = false;\r\n            if (ws) ws.close();\r\n            if (eventWs) eventWs.close();\r\n            clearTimeout(reconnectTimeout);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <WebSocketContext.Provider value={{\r\n            wsData,\r\n            isConnected,\r\n            notifications,\r\n            unreadCount,\r\n            markAsRead,\r\n            markAllAsRead,\r\n            clearNotifications\r\n        }}>\r\n            {children}\r\n        </WebSocketContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useWebSocket = () => {\r\n    const context = useContext(WebSocketContext);\r\n    if (context === undefined) {\r\n        throw new Error('useWebSocket must be used within a WebSocketProvider');\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\lib\\themes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\pages\\LoginPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\services\\SpeedtestService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\setupTests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\src\\utils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\Gravity\\StatSea\\frontend\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
